<div class="admin_content_innerBox">
	<div class="admin_scrollBox">
		<div class="admin_ui_header">
			<i class="fa fa-table fa-2x admin_ui_mainColor"></i>
			<span class="maintitle">秀图管理</span>
		</div>	
		<div class="admin_ui_cont">
			<div class="admin_ui_search">
				<div style="float:right;height:30px;">
					<input type="text" style="width:250px;height:30px;border:1px solid #ccc;margin-left:10px;" class="ui-input" id="search" placeholder="请输入关键词进行搜索">
					<i class="fa fa-search" style="margin-left:-30px;cursor:pointer;width:20px;height:20px;" id="searching"></i>
				</div>
			</div>
			<table class="admin_ui_table">
				<thead>
					<tr>
						<th>id</th>
						<th>发布人</th>
						<th>点赞数</th>
						<th>评论数</th>
						<th>点击量</th>
						<th>是否置顶</th>
						<th>操作</th>
					</tr>
				</thead>
				<tbody id="showImageManagement_data" class="admin_ui_table_hoverEffect">
				</tbody>
			</table>
			<div class="admin_ui_pagination">
				
			</div>
		</div>
	</div>
</div>
<script type="text/javascript">
	$.when(getShowRank(1,0)).done(function(data){
		if(data.state == 0){
			var html = "";
			for(var i = 0, length = data.show.length; i < length; i++){
				var show = data.show[i];
				var showDataString = encodeURI(JSON.stringify(show));
				html+= '<tr data-showId="'+show.id+'">'+
							'<td>'+show.id+'</td>'+
							'<td>'+"用户名"+'</td>'+
							'<td>'+
								show.like+
							'</td>'+
							'<td>'+
								show.comment+
							'</td>'+
							'<td>'+
								show.read+
							'</td>'+
							'<td>'+
								'<div class="admin_ui_select">'+
									'<select data-topShowButton>'+
										'<option value="1" '+(show._top?" selected":"")+'>是</option>'+
										'<option value="0" '+(show._top?"":" selected")+'>否</option>'+
									'</select>'+
								'</div>'+
							'</td>'+
							'<td class="admin_ui_table_action">'+
								'<a href="#/showImageManagementDetail.html?'+showDataString+'" class="iconButton checkIcon">'+
									'<i class="fa fa-eye"></i>'+
									'查看'+
								'</a>'+
							'</td>'+
						'</tr>';
			}
			$("#showImageManagement_data").append(html);
			TablePage(".admin_ui_table",10);
		}
	});
	$("#showImageManagement_data").on('change','[data-topShowButton]',function(e){
		var $this = $(this);
		var showId = $this.closest("tr").attr("data-showId");
		if($(this).val() == 0){
			// 取消置顶
			$.when(cancelTopShow(showId)).done(function(data){
				if(data.state == 0){
					alert("取消置顶成功！");
				}
				else{
					$this.val(1);
				}
			});
		}
		else{
			// 置顶
			$.when(topShow(showId)).done(function(data){
				if(data.state == 0){
					alert("置顶成功！");
				}
				else{
					$this.val(0);
				}
			});
		}
	});
</script>